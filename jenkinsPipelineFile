pipeline {
    agent any
    environment {
	WORKSPACE="/home/jenkins/jenkins-data/jenkins_home/workspace/pipeline-docker-maven"
	PASS = credentials('hub.docker.com')
	IMAGE = "maven-project"
	}
    stages {
        stage('Build') {
            steps {
		sh '''
		./jenkins/build/01-mvn.sh mvn -B -D skipTests clean package
		./jenkins/build/04-build.sh		
		'''
	        }
            post {
                success {
           		 archiveArtifacts artifacts: 'java-app/target/*.jar', fingerprint: true
       			}
    		}	

	}
        stage('Test') {
            steps {	
                sh './jenkins/test/01-mvn-test.sh mvn test'
		}
	
        }
        stage('Push') {
            steps {
		sh './jenkins/push/push.sh'

           	}
        }
	stage('Deploy') {
            steps {
                sh './jenkins/deploy/deploy.sh'

           	}
        }
    }
}

